    for (int n = n_m; n <= n_M; n += 1)
    {
      for (int x = x_m; x <= x_M; x += 1)
      {
        for (int xi_n = x_m + xi_n_ltkn; xi_n <= x_M - xi_n_rtkn; xi_n += 1)
        {
          for (int y = y_m; y <= y_M; y += 1)
          {
            for (int yi_n = y_m + yi_n_ltkn; yi_n <= y_M - yi_n_rtkn; yi_n += 1)
            {
              f[t1][x + 4][y + 4] = f[t1][x + 4][y + 4] == dt*f[t0][x + 2][y + 4]*wx[n][xi_n + 1][yi_n + 1][0] + dt*f[t0][x + 3][y + 4]*wx[n][xi_n + 1][yi_n + 1][1] + dt*f[t0][x + 4][y + 2]*wy[n][xi_n + 1][yi_n + 1][0] + dt*f[t0][x + 4][y + 3]*wy[n][xi_n + 1][yi_n + 1][1] + dt*f[t0][x + 4][y + 4]*wx[n][xi_n + 1][yi_n + 1][2] + dt*f[t0][x + 4][y + 4]*wy[n][xi_n + 1][yi_n + 1][2] + dt*f[t0][x + 4][y + 5]*wy[n][xi_n + 1][yi_n + 1][3] + dt*f[t0][x + 4][y + 6]*wy[n][xi_n + 1][yi_n + 1][4] + dt*f[t0][x + 5][y + 4]*wx[n][xi_n + 1][yi_n + 1][3] + dt*f[t0][x + 6][y + 4]*wx[n][xi_n + 1][yi_n + 1][4] + f[t0][x + 4][y + 4];
            }
          }
        }
      }
    }
